<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.7 Exercises | Introduction to Econometrics with R</title>
  <meta name="description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="3.7 Exercises | Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.econometrics-with-r.org//images/cover.png" />
  <meta property="og:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="github-repo" content="mca91/EconometricsWithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.7 Exercises | Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="twitter:image" content="https://www.econometrics-with-r.org//images/cover.png" />

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber, and Martin Schmelzer" />


<meta name="date" content="2023-07-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="3.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- font families -->

<link href="https://fonts.googleapis.com/css?family=PT+Sans|Pacifico|Source+Sans+Pro" rel="stylesheet">

<script src="js/hideOutput.js"></script>

<!-- Mathjax -->
<script type="text/javascript" id="MathJax-script" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/mml-chtml.min.js"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script type="application/json" class="js-hypothesis-config">
{
"showHighlights": false
}
</script>
<script async defer src="https://hypothes.is/embed.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><center><img src="images/logo.png" alt="logo" width="50%" height="50%"style="margin: 15px 0 0 0"></center></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-colophon.html"><a href="1.1-colophon.html"><i class="fa fa-check"></i><b>1.1</b> Colophon</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-a-very-short-introduction-to-r-and-rstudio.html"><a href="1.2-a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-lrwor.html"><a href="2-lrwor.html"><i class="fa fa-check"></i><b>2</b> Linear Regression with One Regressor</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-simple-linear-regression.html"><a href="2.1-simple-linear-regression.html"><i class="fa fa-check"></i><b>2.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="2.2-estimating-the-coefficients-of-the-linear-regression-model.html"><i class="fa fa-check"></i><b>2.2</b> Estimating the Coefficients of the Linear Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="2.2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="2.2-estimating-the-coefficients-of-the-linear-regression-model.html#the-ordinary-least-squares-estimator"><i class="fa fa-check"></i>The Ordinary Least Squares Estimator</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2.3-measures-of-fit.html"><a href="2.3-measures-of-fit.html"><i class="fa fa-check"></i><b>2.3</b> Measures of Fit</a>
<ul>
<li class="chapter" data-level="" data-path="2.3-measures-of-fit.html"><a href="2.3-measures-of-fit.html#the-coefficient-of-determination"><i class="fa fa-check"></i>The Coefficient of Determination</a></li>
<li class="chapter" data-level="" data-path="2.3-measures-of-fit.html"><a href="2.3-measures-of-fit.html#the-standard-error-of-the-regression"><i class="fa fa-check"></i>The Standard Error of the Regression</a></li>
<li class="chapter" data-level="" data-path="2.3-measures-of-fit.html"><a href="2.3-measures-of-fit.html#application-to-the-test-score-data"><i class="fa fa-check"></i>Application to the Test Score Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-tlsa.html"><a href="2.4-tlsa.html"><i class="fa fa-check"></i><b>2.4</b> The Least Squares Assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="2.4-tlsa.html"><a href="2.4-tlsa.html#assumption-1-the-error-term-has-conditional-mean-of-zero"><i class="fa fa-check"></i>Assumption 1: The Error Term has Conditional Mean of Zero</a></li>
<li class="chapter" data-level="" data-path="2.4-tlsa.html"><a href="2.4-tlsa.html#assumption-2-independently-and-identically-distributed-data"><i class="fa fa-check"></i>Assumption 2: Independently and Identically Distributed Data</a></li>
<li class="chapter" data-level="" data-path="2.4-tlsa.html"><a href="2.4-tlsa.html#assumption-3-large-outliers-are-unlikely"><i class="fa fa-check"></i>Assumption 3: Large Outliers are Unlikely</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2.5-tsdotoe.html"><a href="2.5-tsdotoe.html"><i class="fa fa-check"></i><b>2.5</b> The Sampling Distribution of the OLS Estimator</a>
<ul>
<li class="chapter" data-level="" data-path="2.5-tsdotoe.html"><a href="2.5-tsdotoe.html#simulation-study-1"><i class="fa fa-check"></i>Simulation Study 1</a></li>
<li class="chapter" data-level="" data-path="2.5-tsdotoe.html"><a href="2.5-tsdotoe.html#simulation-study-2"><i class="fa fa-check"></i>Simulation Study 2</a></li>
<li class="chapter" data-level="" data-path="2.5-tsdotoe.html"><a href="2.5-tsdotoe.html#simulation-study-3"><i class="fa fa-check"></i>Simulation Study 3</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2.6-exercises-4.html"><a href="2.6-exercises-4.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-htaciitslrm.html"><a href="3-htaciitslrm.html"><i class="fa fa-check"></i><b>3</b> Hypothesis Tests and Confidence Intervals in the Simple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><a href="3.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><i class="fa fa-check"></i><b>3.1</b> Testing Two-Sided Hypotheses Concerning the Slope Coefficient</a></li>
<li class="chapter" data-level="3.2" data-path="3.2-cifrc.html"><a href="3.2-cifrc.html"><i class="fa fa-check"></i><b>3.2</b> Confidence Intervals for Regression Coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="3.2-cifrc.html"><a href="3.2-cifrc.html#simulation-study-confidence-intervals"><i class="fa fa-check"></i>Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-rwxiabv.html"><a href="3.3-rwxiabv.html"><i class="fa fa-check"></i><b>3.3</b> Regression when X is a Binary Variable</a></li>
<li class="chapter" data-level="3.4" data-path="3.4-hah.html"><a href="3.4-hah.html"><i class="fa fa-check"></i><b>3.4</b> Heteroskedasticity and Homoskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="3.4-hah.html"><a href="3.4-hah.html#a-real-world-example-for-heteroskedasticity"><i class="fa fa-check"></i>A Real-World Example for Heteroskedasticity</a></li>
<li class="chapter" data-level="" data-path="3.4-hah.html"><a href="3.4-hah.html#should-we-care-about-heteroskedasticity"><i class="fa fa-check"></i>Should We Care About Heteroskedasticity?</a></li>
<li class="chapter" data-level="" data-path="3.4-hah.html"><a href="3.4-hah.html#computation-of-heteroskedasticity-robust-standard-errors"><i class="fa fa-check"></i>Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3.5-the-gauss-markov-theorem.html"><a href="3.5-the-gauss-markov-theorem.html"><i class="fa fa-check"></i><b>3.5</b> The Gauss-Markov Theorem</a>
<ul>
<li class="chapter" data-level="" data-path="3.5-the-gauss-markov-theorem.html"><a href="3.5-the-gauss-markov-theorem.html#simulation-study-blue-estimator"><i class="fa fa-check"></i>Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><a href="3.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><i class="fa fa-check"></i><b>3.6</b> Using the t-Statistic in Regression When the Sample Size Is Small</a></li>
<li class="chapter" data-level="3.7" data-path="3.7-exercises-5.html"><a href="3.7-exercises-5.html"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click "Annotate" in the pop-up menu. You can also see the annotations of others: click the arrow in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="exercises-5" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Exercises<a href="3.7-exercises-5.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="testing-two-null-hypotheses-separately" class="section level4 unnumbered hasAnchor DCexercise">
<h4>1. Testing Two Null Hypotheses Separately<a href="3.7-exercises-5.html#testing-two-null-hypotheses-separately" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the estimated regression model</p>
<p><span class="math display">\[ \widehat{TestScore} = \underset{(23.96)}{567.43} - \underset{(0.85)}{7.15} \times STR, \, R^2 = 0.8976, \, SER=15.19 \]</span></p>
<p>with standard errors in parentheses.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute the <span class="math inline">\(p\)</span>-value for a <span class="math inline">\(t\)</span>-test of the hypothesis that the intercept is zero against the two-sided alternative that it is non-zero. Save the result to <tt>p_int</tt></li>
<li>Compute the <span class="math inline">\(p\)</span>-value for a <span class="math inline">\(t\)</span>-test of the hypothesis that the coefficient of <tt>STR</tt> is zero against the two-sided alternative that it is non-zero. Save the result to <tt>p_STR</tt></li>
</ul>
<iframe src="DCL/ex5_1.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p>Both hypotheses can be tested individually using a two-sided test. Use <tt>pnorm()</tt> to obtain cumulated probabilities for standard normally distributed outcomes.</p>
</div>
<div id="two-null-hypotheses-you-cannot-reject-can-you" class="section level4 unnumbered hasAnchor DCexercise">
<h4>2. Two Null Hypotheses You Cannot Reject, Can You?<a href="3.7-exercises-5.html#two-null-hypotheses-you-cannot-reject-can-you" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider again the estimated regression model</p>
<p><span class="math display">\[\widehat{TestScore} = \underset{(23.96)}{567.43} - \underset{(0.85)}{7.15} \times STR, \, R^2 = 0.8976, \,SER=15.19\]</span></p>
<p>Can you reject the null hypotheses discussed in the previous code exercise using individual <span class="math inline">\(t\)</span>-tests at the <span class="math inline">\(5\%\)</span> significance level?</p>
<p>The variables <tt>t_int</tt> and <tt>t_STR</tt> are the <span class="math inline">\(t\)</span>-statistics. Both are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Gather <tt>t_int</tt> and <tt>t_STR</tt> in a vector <tt>test</tt> and use logical operators to check whether the corresponding rejection rule applies.</li>
</ul>
<iframe src="DCL/ex5_2.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li>Both tests are two-sided <span class="math inline">\(t\)</span>-tests. Key Concept 5.2 recaps how a two-sided <span class="math inline">\(t\)</span>-test is conducted.</li>
<li>Use <tt>qnorm()</tt> to obtain standard normal critical values.</li>
</ul>
</div>
<div id="confidence-intervals" class="section level4 unnumbered hasAnchor DCexercise">
<h4>3. Confidence Intervals<a href="3.7-exercises-5.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><tt>mod</tt>, the object of class <tt>lm</tt> which contains the estimated regression model <span class="math display">\[\widehat{TestScore} = \underset{(23.96)}{567.43} - \underset{(0.85)}{7.15} \times STR, \, R^2 = 0.8976, \,SER=15.19\]</span> is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<p>Compute <span class="math inline">\(90\%\)</span> confidence intervals for both coefficients.</p>
<iframe src="DCL/ex5_3.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p>Use the function <tt>confint()</tt>, see <tt>?confint</tt>. The argument <tt>level</tt> sets the confidence level to be used.</p>
</div>
<div id="a-confidence-interval-for-the-mean-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4>4. A Confidence Interval for the Mean I<a href="3.7-exercises-5.html#a-confidence-interval-for-the-mean-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the regression model <span class="math display">\[Y_i = \beta_1 + u_i\]</span> where <span class="math inline">\(Y_i \sim \mathcal{N}(\mu, \sigma^2)\)</span>. Following the discussion preceding equation <a href="3.2-cifrc.html#eq:KI">(3.1)</a>, a <span class="math inline">\(95\%\)</span> confidence interval for the mean of the <span class="math inline">\(Y_i\)</span> can be computed as</p>
<p><span class="math display">\[CI^{\mu}_{0.95} = \left[\hat\mu - 1.96 \times \frac{\sigma}{\sqrt{n}}; \, \hat\mu + 1.96 \times \frac{\sigma}{\sqrt{n}} \right].\]</span></p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Sample <span class="math inline">\(n=100\)</span> observations from a normal distribution with variance <span class="math inline">\(100\)</span> and mean <span class="math inline">\(10\)</span>.</li>
<li>Use the sample to estimate <span class="math inline">\(\beta_1\)</span>. Save the estimate in <tt>mu_hat</tt>.</li>
<li>Assume that <span class="math inline">\(\sigma^2 = 100\)</span> is known. Replace the <tt>NA</tt>s in the code below to obtain a <span class="math inline">\(95\%\)</span> confidence interval for the mean of the <span class="math inline">\(Y_i\)</span>.</li>
</ul>
<iframe src="DCL/ex5_4.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p>Use the function <tt>confint()</tt>, see <tt>?confint</tt>. The argument <tt>level</tt> sets the confidence level.</p>
</div>
<div id="a-confidence-interval-for-the-mean-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>5. A Confidence Interval for the Mean II<a href="3.7-exercises-5.html#a-confidence-interval-for-the-mean-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For historical reasons, some <tt>R</tt> functions which we use to obtain inference on model parameters, among them <tt>confint()</tt> and <tt>summary()</tt>, rely on the <span class="math inline">\(t\)</span>-distribution instead of using the large-sample normal approximation. This is why for small sample sizes (and hence small degrees of freedom), <span class="math inline">\(p\)</span>-values and confidence intervals reported by these functions deviate from those computed using critical values or cumulative probabilities of the standard normal distribution.</p>
<p>The <span class="math inline">\(95\%\)</span> confidence interval for the mean in the previous exercise is <span class="math inline">\([9.13, 13.05]\)</span>.</p>
<p><strong>Instructions:</strong></p>
<p>100 observations sampled from a normal distribution with <span class="math inline">\(\mu=10\)</span> and <span class="math inline">\(\sigma^2=100\)</span> have been assigned to the vector <tt>s</tt> which is available in your environment.</p>
<p>Set up a suitable regression model to estimate the mean of the observations in <tt>s</tt>. Then use <tt>confint()</tt> to compute a <span class="math inline">\(95\%\)</span> confidence interval for the mean.</p>
<p>(Check that the result is different from the interval reported above.)</p>
<iframe src="DCL/ex5_5.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="regression-on-a-dummy-variable-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4>6. Regression on a Dummy Variable I<a href="3.7-exercises-5.html#regression-on-a-dummy-variable-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Chapter <a href="3.3-rwxiabv.html#rwxiabv">3.3</a> discusses regression when <span class="math inline">\(X\)</span> is a dummy variable. We have used a <tt>for()</tt> loop to generate a binary variable indicating whether a schooling district in the <tt>CASchools</tt> data set has a student-teacher ratio below <span class="math inline">\(20\)</span>. Though it is instructive to use a loop for this, there are alternate ways to achieve the same with fewer lines of code.</p>
<p>A <tt>data.frame</tt> <tt>DF</tt> with <span class="math inline">\(100\)</span> observations of a variable <tt>X</tt> is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use <tt>ifelse()</tt> to generate a binary vector <tt>dummy</tt> indicating whether the observations in <tt>X</tt> are <em>positive</em>.</p></li>
<li><p>Append <tt>dummy</tt> to the <tt>data.frame</tt> <tt>DF</tt>.</p></li>
</ul>
<iframe src="DCL/ex5_6.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="regression-on-a-dummy-variable-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>7. Regression on a Dummy Variable II<a href="3.7-exercises-5.html#regression-on-a-dummy-variable-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A <tt>data.frame</tt> <tt>DF</tt> with 100 observations on <tt>Y</tt> and the binary variable <tt>D</tt> from the previous exercise is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Compute the group-specific sample means of the observations in <tt>Y</tt>: save the mean of observations in <tt>Y</tt> where <tt>D == 1</tt> to <tt>mu_Y_D1</tt> and assign the mean of those observations with <tt>D == 0</tt> to <tt>mu_Y_D0</tt>.</p></li>
<li><p>Use <tt>lm()</tt> to regress <tt>Y</tt> on <tt>D</tt>, i.e., estimate the coefficients in the model <span class="math display">\[Y_i = \beta_0 + \beta_1 \times D_i + u_i.\]</span></p></li>
</ul>
<p>Also check that the estimates of the coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> reflect specific sample means. Can you tell which (no code submission needed)?</p>
<iframe src="DCL/ex5_7.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="regression-on-a-dummy-variable-iii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>8. Regression on a Dummy Variable III<a href="3.7-exercises-5.html#regression-on-a-dummy-variable-iii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this exercise, you have to visualize some of the results from the dummy regression model <span class="math display">\[\widehat{Y}_i = -0.66 + 1.43 \times D_i\]</span> estimated in the previous exercise.</p>
<p>A <tt>data.frame</tt> <tt>DF</tt> with 100 observations on <tt>Y</tt> and the binary variable <tt>dummy</tt> as well as the model object <tt>dummy_mod</tt> from the previous exercise are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Start by drawing a visually appealing plot of the observations on <span class="math inline">\(Y\)</span> and <span class="math inline">\(D\)</span> based on the code chunk provided in <tt>Script.R</tt>. Replace the <tt>???</tt> by the correct expressions!</p></li>
<li><p>Add the regression line to the plot.</p></li>
</ul>
<iframe src="DCL/ex5_8.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="gender-wage-gap-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4>9. Gender Wage Gap I<a href="3.7-exercises-5.html#gender-wage-gap-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The cross-section data set <tt>CPS1985</tt> is a subsample from the May 1985 <em>Current Population Survey</em> conducted by the <em>US Census Bureau</em> which contains observations on, among other things, wage and the gender of employees.</p>
<p><tt>CPS1985</tt> is part of the package <tt>AER</tt>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Attach the package <tt>AER</tt> and load the data set <tt>CPS1985</tt>.</p></li>
<li><p>Estimate the dummy regression model <span class="math display">\[wage_i = \beta_0 + \beta_1 \cdot gender_i + u_i\]</span> where</p>
<p><span class="math display">\[\begin{align*}
    gender_i =
    \begin{cases}
      1, &amp; \text{if employee} \, i \, \text{is female,} \\
      0, &amp; \text{if employee} \, i \,  \text{is male.}
    \end{cases}
  \end{align*}\]</span></p>
<p>Save the result in <tt>dummy_mod</tt>.</p></li>
</ul>
<iframe src="DCL/ex5_9.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="gender-wage-gap-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>10. Gender Wage Gap II<a href="3.7-exercises-5.html#gender-wage-gap-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The wage regression from the previous exercise yields <span class="math display">\[\widehat{wage}_i = 9.995 - 2.116 \cdot gender_i.\]</span></p>
<p>The model object <tt>dummy_mod</tt> is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Test the hypothesis that the coefficient on <span class="math inline">\(gender_i\)</span> is zero against the alternative that it is non-zero. The null hypothesis implies that there is no gender wage gap. Use the heteroskedasticity-robust estimator proposed by <span class="citation">White (<a href="#ref-white1980" role="doc-biblioref">1980</a>)</span>.</li>
</ul>
<iframe src="DCL/ex5_10.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>vcovHC()</tt> computes heteroskedasticity-robust estimates of the covariance matrix of the coefficient estimators for the model supplied. The estimator proposed by <span class="citation">White (<a href="#ref-white1980" role="doc-biblioref">1980</a>)</span> is computed if you set <tt>type = “HC0”</tt>.</p></li>
<li><p>The function <tt>coeftest()</tt> performs significance tests for the coefficients in model objects. A covariance matrix can be supplied using the argument <tt>vcov.</tt>.</p></li>
</ul>
</div>
<div id="computation-of-heteroskedasticity-robust-standard-errors-1" class="section level4 unnumbered hasAnchor DCexercise">
<h4>11. Computation of Heteroskedasticity-Robust Standard Errors<a href="3.7-exercises-5.html#computation-of-heteroskedasticity-robust-standard-errors-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the simple regression model, the covariance matrix of the coefficient estimators is denoted</p>
<p><span class="math display">\[\begin{equation}
\text{Var}
  \begin{pmatrix}
    \hat\beta_0 \
    \hat\beta_1
  \end{pmatrix} =
\begin{pmatrix}
  \text{Var}(\hat\beta_0) &amp; \text{Cov}(\hat\beta_0,\hat\beta_1) \\
\text{Cov}(\hat\beta_0,\hat\beta_1) &amp; \text{Var}(\hat\beta_1)
\end{pmatrix}
\end{equation}\]</span>\end{equation}</p>
<p>The function <tt>vcovHC</tt> can be used to obtain estimates of this matrix for a model object of interest.</p>
<p><tt>dummy_mod</tt>, a model object containing the wage regression dealt with in Exercises 9 and 10 is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Compute robust standard errors of the type <tt>HC1</tt> for the coefficients estimators in the model object <tt>dummy_mod</tt>. Store the standard errors in a vector named <tt>rob_SEs</tt>.</li>
</ul>
<iframe src="DCL/ex5_11.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints</strong></p>
<ul>
<li>The standard errors we seek can be obtained by taking the square root of the diagonal elements of the estimated covariance matrix.</li>
<li><tt>diag(A)</tt> returns the diagonal elements of the matrix <tt>A</tt>.</li>
</ul>
</div>
<div id="robust-confidence-intervals" class="section level4 unnumbered hasAnchor DCexercise">
<h4>12. Robust Confidence Intervals<a href="3.7-exercises-5.html#robust-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The function <tt>confint()</tt> computes confidence intervals for regression models using homoskedasticity-only standard errors so this function is not an option when there is heteroskedasticity.</p>
<p>The function <tt>Rob_CI()</tt> in <tt>script.R</tt> is meant to compute and report heteroskedasticity-robust confidence intervals for both model coefficients in a simple regression model.</p>
<p><tt>dummy_mod</tt>, a model object containing the wage regression dealt with in the previous exercises is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Complete the code of <tt>Rob_CI()</tt> given in <tt>Script.R</tt> such that lower and upper bounds of <span class="math inline">\(95\%\)</span> robust confidence intervals are returned. Use standard errors of the type <tt>HC1</tt>.</p></li>
<li><p>Use the function <tt>Rob_CI()</tt> to obtain <span class="math inline">\(95\%\)</span> confidence intervals for the model coefficients in <tt>dummy_mod</tt>.</p></li>
</ul>
<iframe src="DCL/ex5_12.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="a-small-simulation-study-i" class="section level4 unnumbered hasAnchor DCexercise">
<h4>13. A Small Simulation Study — I<a href="3.7-exercises-5.html#a-small-simulation-study-i" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider the data generating process (DGP)
<span class="math display" id="eq:asss">\[\begin{align}
  X_i \sim&amp; \, \mathcal{U}[2,10], \notag \\
  e_i \sim&amp; \, \mathcal{N}(0, X_i), \notag \\
  Y_i =&amp; \, \beta_1 X_i + e_i, \tag{3.4}  
\end{align}\]</span>
where <span class="math inline">\(\mathcal{U}[2,10]\)</span> denotes the uniform distribution on the interval <span class="math inline">\([2,10]\)</span> and <span class="math inline">\(\beta_1=2\)</span>.</p>
<p>Notice that the errors <span class="math inline">\(e_i\)</span> are heteroskedastic since the variance of the <span class="math inline">\(e_i\)</span> is a function of <span class="math inline">\(X_i\)</span>.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li>Write a function <tt>DGP_OLS</tt> that generates a sample <span class="math inline">\((X_i,Y_i)\)</span>, <span class="math inline">\(i=1,…,100\)</span> using the DGP above and returns the OLS estimate of <span class="math inline">\(\beta_1\)</span> based on this sample.</li>
</ul>
<iframe src="DCL/ex5_13.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hint:</strong></p>
<p><tt>runif()</tt> can be used to obtain random samples from a uniform distribution, see <tt>?runif</tt>.</p>
</div>
<div id="a-small-simulation-study-ii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>14. A Small Simulation Study — II<a href="3.7-exercises-5.html#a-small-simulation-study-ii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The function <tt>DGP_OLS()</tt> from the previous exercise is available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Use <tt>replicate()</tt> to generate a sample of <span class="math inline">\(1000\)</span> OLS estimates <span class="math inline">\(\widehat{\beta}_1\)</span> using the function <tt>DGP_OLS</tt>. Store the estimates in a vector named <tt>estimates</tt>.</p></li>
<li><p>Next, estimate the variance of <span class="math inline">\(\widehat{\beta}_1\)</span> in <a href="3.7-exercises-5.html#eq:asss">(3.4)</a>: compute the sample variance of the <span class="math inline">\(1000\)</span> OLS estimates in <tt>estimates</tt>. Store the result in <tt>est_var_OLS</tt>.</p></li>
</ul>
<iframe src="DCL/ex5_14.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
</div>
<div id="a-small-simulation-study-iii" class="section level4 unnumbered hasAnchor DCexercise">
<h4>15. A Small Simulation Study — III<a href="3.7-exercises-5.html#a-small-simulation-study-iii" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>According to the the Gauss-Markov theorem, the OLS estimator in linear regression models is no longer the most efficient estimator among the conditionally unbiased linear estimators when there is heteroskedasticity. In other words, the OLS estimator loses the BLUE property when the assumption of homoskedasticity is violated.</p>
<p>It turns out that OLS applied to the weighted observations <span class="math inline">\((w_i X_i, w_i Y_i)\)</span> where <span class="math inline">\(w_i=\frac{1}{\sigma_i}\)</span> is the BLUE estimator under heteroskedasticity. This estimator is called the <em>weighted least squares</em> (WLS) estimator. Thus, when there is heteroskedasticity, the WLS estimator has lower variance than OLS.</p>
<p>The function <tt>DGP_OLS()</tt> and the estimated variance <tt>est_var_OLS</tt> from the previous exercises are available in your working environment.</p>
<p><strong>Instructions:</strong></p>
<ul>
<li><p>Write a function <tt>DGP_WLS()</tt> that generates <span class="math inline">\(100\)</span> samples using the DGP introduced in Exercise 13 and returns the WLS estimate of <span class="math inline">\(\beta_1\)</span>. Treat <span class="math inline">\(\sigma_i\)</span> as known, i.e., set <span class="math inline">\(w_i=\frac{1}{\sqrt{X_i}}\)</span>.</p></li>
<li><p>Repeat exercise 14 using <tt>DGP_WLS()</tt>. Store the variance estimate in <tt>est_var_WLS</tt>.</p></li>
<li><p>Compare the estimated variances <tt>est_var_OLS</tt> and <tt>est_var_WLS</tt> using logical operators (<tt>&lt;</tt> or <tt>&gt;</tt>).</p></li>
</ul>
<iframe src="DCL/ex5_15.html" frameborder="0" scrolling="no" style="width:100%;height:340px">
</iframe>
<p><strong>Hints:</strong></p>
<ul>
<li><p><tt>DGP_WLS()</tt> can be obtained using a modified code of <tt>DGP_OLS()</tt>.</p></li>
<li><p>Remember that functions are objects and you may print the code of a function to the console.</p></li>
</ul>
</div>

</div>
<!-- </div> -->
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-white1980" class="csl-entry">
White, Halbert. 1980. <span>“<span>A</span> <span>H</span>eteroskedasticity-<span>C</span>onsistent <span>C</span>ovariance <span>M</span>atrix <span>E</span>stimator and a <span>D</span>irect <span>T</span>est for <span>H</span>eteroskedasticity.”</span> <em><span>E</span>conometrica</em> 48 (4): pp. 817–838.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/mca91/EconometricsWithR/edit/master/05-ch5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ITER.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
