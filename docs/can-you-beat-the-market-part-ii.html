<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Using R for Introduction to Econometrics</title>
  <meta name="description" content="Using <tt>R</tt> for Introduction to Econometrics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Using R for Introduction to Econometrics" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="Emwikts1970/URFITE-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Using R for Introduction to Econometrics" />
  
  
  

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber and Martin Schmelzer">


<meta name="date" content="2018-08-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="niib.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="js/hideOutput.js"></script>
<script type="text/javascript" src="MathJax-2.7.2/MathJax.js?config=default"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>

<!-- datacamp-light-latest -->

<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>


<!-- <script src="js/d3.v3.min.js"></script>
<script src="js/leastsquares.js"></script>
<script src="js/d3functions.js"></script>
<script src="d3.slider.js"></script>
<script src="slrm.js"></script> -->


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">URFITE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="a-very-short-introduction-to-r-and-rstudio.html"><a href="a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ittsraf.html"><a href="ittsraf.html"><i class="fa fa-check"></i><b>2</b> Introduction to Time Series Regression and Forecasting</a><ul>
<li class="chapter" data-level="2.1" data-path="using-regression-models-for-forecasting.html"><a href="using-regression-models-for-forecasting.html"><i class="fa fa-check"></i><b>2.1</b> Using Regression Models for Forecasting</a></li>
<li class="chapter" data-level="2.2" data-path="tsdasc.html"><a href="tsdasc.html"><i class="fa fa-check"></i><b>2.2</b> Time Series Data and Serial Correlation</a><ul>
<li class="chapter" data-level="" data-path="tsdasc.html"><a href="tsdasc.html#notation-lags-differences-logarithms-and-growth-rates"><i class="fa fa-check"></i>Notation, Lags, Differences, Logarithms and Growth Rates</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="autoregressions.html"><a href="autoregressions.html"><i class="fa fa-check"></i><b>2.3</b> Autoregressions</a><ul>
<li><a href="autoregressions.html#autoregressive-models-of-order-p">Autoregressive Models of Order <span class="math inline">\(p\)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cybtmpi.html"><a href="cybtmpi.html"><i class="fa fa-check"></i><b>2.4</b> Can You Beat the Market? (Part I)</a></li>
<li class="chapter" data-level="2.5" data-path="apatadlm.html"><a href="apatadlm.html"><i class="fa fa-check"></i><b>2.5</b> Additional Predictors and The ADL Model</a><ul>
<li class="chapter" data-level="" data-path="apatadlm.html"><a href="apatadlm.html#forecast-uncertainty-and-forecast-intervals"><i class="fa fa-check"></i>Forecast Uncertainty and Forecast Intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="llsuic.html"><a href="llsuic.html"><i class="fa fa-check"></i><b>2.6</b> Lag Length Selection Using Information Criteria</a></li>
<li class="chapter" data-level="2.7" data-path="nit.html"><a href="nit.html"><i class="fa fa-check"></i><b>2.7</b> Nonstationarity I: Trends</a></li>
<li class="chapter" data-level="2.8" data-path="niib.html"><a href="niib.html"><i class="fa fa-check"></i><b>2.8</b> Nonstationarity II: Breaks</a></li>
<li class="chapter" data-level="2.9" data-path="can-you-beat-the-market-part-ii.html"><a href="can-you-beat-the-market-part-ii.html"><i class="fa fa-check"></i><b>2.9</b> Can You Beat the Market? (Part II)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using <tt>R</tt> for Introduction to Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. You can also see the annotations of others: click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="can-you-beat-the-market-part-ii" class="section level2">
<h2><span class="header-section-number">2.9</span> Can You Beat the Market? (Part II)</h2>
<p>The dividend yield (the ratio of current dividends to the stock price) can be considered as an indicator of future dividends: if a stock has a high current dividend yield, it can be considered undervalued and it can be presumed that the price of the stock goes up in the future, meaning that future excess returns go up.</p>
<p>This presumption can be examined using ADL models of excess returns, where lags of the logarithm of the stock’s dividend yield serve as additional regressors.</p>
<p>Unfortunately, a graphical inspection of the time series of the logarithm of the dividend yield casts doubt on the assumption that the series is stationary which, as has been discussed in Chapter <a href="nit.html#nit">2.7</a>, is necessary to obtain meaningful results in a regression analysis.</p>
<div class="unfolded">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot logarithm of dividend yield series</span>
<span class="kw">plot</span>(StockReturns[, <span class="dv">2</span>], 
     <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>, 
     <span class="dt">lwd =</span> <span class="dv">2</span>, 
     <span class="dt">ylab =</span> <span class="st">&quot;Logarithm&quot;</span>, 
     <span class="dt">main =</span> <span class="st">&quot;Dividend Yield for CRSP Index&quot;</span>)</code></pre></div>
<p><img src="URFITE_files/figure-html/unnamed-chunk-100-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<p>The Dickey-Fuller test statistic for an autoregressive unit root in an AR(<span class="math inline">\(1\)</span>) model with drift provides further evidence that the series might be nonstationary.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># DF-Regression for log dividend yield</span>
LDivYield &lt;-<span class="st"> </span><span class="kw">dynlm</span>(<span class="kw">d</span>(ln_DivYield) <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ln_DivYield), <span class="dt">data =</span> StockReturns,
      <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>)
      )

<span class="kw">summary</span>(LDivYield)<span class="op">$</span>coef</code></pre></div>
<pre><code>##                    Estimate  Std. Error   t value  Pr(&gt;|t|)
## (Intercept)    -2.728786496 2.083152348 -1.309931 0.1908042
## L(ln_DivYield) -0.007656929 0.005998017 -1.276577 0.2023282</code></pre>
<p>Since the <span class="math inline">\(t\)</span>-value for the coefficient on the lagged logarithm of the dividend yield is <span class="math inline">\(-1.27\)</span>, the hypothesis that the true coefficient is zero cannot be rejected, even at the <span class="math inline">\(10\%\)</span> significance level.</p>
<p>However, it is possible to examine whether the dividend yield has predictive power for excess returns by using its differences in an ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) and an ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) model (remember that differencing a series with a unit root yields a stationary series) although these model specifications do not correspond to the economic reasoning mentioned above. Thus we also estimate a ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) regression using the level of the logarithm of the dividend yield.</p>
<p>Altogether we estimate three different model specifications:</p>
<span class="math display">\[\begin{align*}
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_3 \Delta \log(dividend yield_{t-1}) + u_t \\
  \\
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_2 excess \, returns_{t-2} \\ +&amp; \, \beta_3 \Delta \log(dividend yield_{t-1}) + \beta_4 \Delta \log(dividend yield_{t-2}) + u_t \\
  \\
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_5 \log(dividend yield_{t-1}) + u_t \\
\end{align*}\]</span>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ADL(1,1) (1st difference of log dividend yield)</span>
CRSP_ADL_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ExReturn) <span class="op">+</span><span class="st"> </span><span class="kw">d</span>(<span class="kw">L</span>(ln_DivYield)), 
                    <span class="dt">data =</span> StockReturns,
                    <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>)
              )

<span class="co"># ADL(2,2) (1st &amp; 2nd differences of log dividend yield)</span>
CRSP_ADL_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ExReturn) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(ExReturn, <span class="dv">2</span>) 
                   <span class="op">+</span><span class="st"> </span><span class="kw">d</span>(<span class="kw">L</span>(ln_DivYield)) <span class="op">+</span><span class="st"> </span><span class="kw">d</span>(<span class="kw">L</span>(ln_DivYield, <span class="dv">2</span>)), 
                   <span class="dt">data =</span> StockReturns,
                   <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>)
              )

<span class="co"># ADL(1,1) (level of log dividend yield)</span>
CRSP_ADL_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ExReturn) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(ln_DivYield),
                    <span class="dt">data =</span> StockReturns,
                    <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">1992</span>, <span class="dv">12</span>)
              )</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rob_se_CRSP_ADL &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">sandwich</span>(CRSP_ADL_<span class="dv">1</span>))),
  <span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">sandwich</span>(CRSP_ADL_<span class="dv">2</span>))),
  <span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">sandwich</span>(CRSP_ADL_<span class="dv">3</span>)))
)</code></pre></div>
<p>A tabular representation of the results can then be generated using <tt>stargazer()</tt>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stargazer</span>(CRSP_ADL_<span class="dv">1</span>, CRSP_ADL_<span class="dv">2</span>, CRSP_ADL_<span class="dv">3</span>,
  <span class="dt">title =</span> <span class="st">&quot;ADL Models of Monthly Excess Stock Returns&quot;</span>,
  <span class="dt">header =</span> <span class="ot">FALSE</span>, 
  <span class="dt">type =</span> <span class="st">&quot;latex&quot;</span>,
  <span class="dt">column.sep.width =</span> <span class="st">&quot;-5pt&quot;</span>,
  <span class="dt">no.space =</span> T,
  <span class="dt">digits =</span> <span class="dv">3</span>, 
  <span class="dt">column.labels =</span> <span class="kw">c</span>(<span class="st">&quot;ADL(1,1)&quot;</span>, <span class="st">&quot;ADL(2,2)&quot;</span>, <span class="st">&quot;ADL(1,1)&quot;</span>),
  <span class="dt">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Excess returns on the CSRP value-weighted index&quot;</span>,
  <span class="dt">dep.var.labels.include =</span> <span class="ot">FALSE</span>,
  <span class="dt">covariate.labels =</span> <span class="kw">c</span>(<span class="st">&quot;$excess return_{t-1}$&quot;</span>, 
                       <span class="st">&quot;$excess return_{t-2}$&quot;</span>, 
                       <span class="st">&quot;$1^{st} diff log(dividend yield_{t-1})$&quot;</span>, 
                       <span class="st">&quot;$1^{st} diff log(dividend yield_{t-2})$&quot;</span>, 
                       <span class="st">&quot;$log(dividend yield_{t-1})$&quot;</span>, 
                       <span class="st">&quot;Constant&quot;</span>),
  <span class="dt">se =</span> rob_se_CRSP_ADL
  ) </code></pre></div>



<table style="text-align:center"><tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="3">Dependent Variable: Excess Returns on the CSRP Value-Weighted Index</td></tr>
<tr><td></td><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>ADL(1,1)</td><td>ADL(2,2)</td><td>ADL(1,1)</td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">excess return<sub>t-1</sub></td><td>0.059</td><td>0.042</td><td>0.078</td></tr>
<tr><td style="text-align:left"></td><td>(0.158)</td><td>(0.162)</td><td>(0.057)</td></tr>
<tr><td style="text-align:left">excess return<sub>t-2</sub></td><td></td><td>-0.213</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.193)</td><td></td></tr>
<tr><td style="text-align:left">1<sup>st</sup> diff log(dividend yield<sub>t-1</sub>)</td><td>0.009</td><td>-0.012</td><td></td></tr>
<tr><td style="text-align:left"></td><td>(0.157)</td><td>(0.163)</td><td></td></tr>
<tr><td style="text-align:left">1<sup>st</sup> diff log(dividend yield<sub>t-2</sub>)</td><td></td><td>-0.161</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.185)</td><td></td></tr>
<tr><td style="text-align:left">log(dividend yield<sub>t-1</sub>)</td><td></td><td></td><td>0.026<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.012)</td></tr>
<tr><td style="text-align:left">Constant</td><td>0.309</td><td>0.372<sup>*</sup></td><td>8.987<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.199)</td><td>(0.208)</td><td>(3.912)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>516</td><td>516</td><td>396</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.003</td><td>0.007</td><td>0.018</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>-0.001</td><td>-0.001</td><td>0.013</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>4.338 (df = 513)</td><td>4.337 (df = 511)</td><td>4.407 (df = 393)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>0.653 (df = 2; 513)</td><td>0.897 (df = 4; 511)</td><td>3.683<sup>**</sup> (df = 2; 393)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="3" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'><span id="tab:adlmomesr">Table 2.3: </span> ADL Models of Monthly Excess Stock Returns</p></caption>


<p>Notice that for models (1) and (2) none of the individual <span class="math inline">\(t\)</span>-statistics suggest that the coefficients are different from zero. Also we cannot reject the hypothesis that none of the lags have predictive power for excess returns at any common level of significance (an <span class="math inline">\(F\)</span>-test that the lags have predictive power rejects for both models).</p>
<p>Things are different for model (3). The coefficient on the level of the logarithm of the dividend yield is different from zero at the <span class="math inline">\(5\%\)</span> level and the <span class="math inline">\(F\)</span>-test does not reject at this level either. But we should be suspicious: the high degree of persistence in the dividend yield series probably renders this inference useless because <span class="math inline">\(t\)</span>- and <span class="math inline">\(F\)</span>-statistics may follow distributions that deviate considerably from their theoretical large-sample distributions such that the usual critical values cannot be applied.</p>
<p>If model (3) would be of any use for predicting excess returns, pseudo-out-of-sample forecasts based on (3) should outperform forecasts of an intercept-only model in terms of the sample RMSFE. We can perform this type of comparison using <tt>R</tt> code in the fashion of the applications of Chapter <a href="niib.html#niib">2.8</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># end of sample dates</span>
EndOfSample &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">window</span>(<span class="kw">time</span>(StockReturns), <span class="kw">c</span>(<span class="dv">1992</span>, <span class="dv">12</span>), <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">11</span>)))

<span class="co"># initialize matrix  forecasts</span>
forecasts &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">2</span>, 
                    <span class="dt">ncol =</span> <span class="kw">length</span>(EndOfSample))

<span class="co"># estimation loop over end of sample dates</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(EndOfSample)) {

  <span class="co"># estimate model (3)</span>
  mod3 &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ExReturn) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(ln_DivYield), <span class="dt">data =</span> StockReturns, 
                <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), 
                <span class="dt">end =</span> EndOfSample[i])
  
  <span class="co"># estimate intercept only model</span>
  modconst &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> StockReturns, 
                <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), 
                <span class="dt">end =</span> EndOfSample[i])
  
  <span class="co"># sample data for one-period ahead forecast</span>
  t &lt;-<span class="st"> </span><span class="kw">window</span>(StockReturns, EndOfSample[i], EndOfSample[i])
  
  <span class="co"># compute forecast</span>
  forecasts[,i] &lt;-<span class="st"> </span><span class="kw">c</span>(
    <span class="kw">coef</span>(mod3) <span class="op">%*%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, t[<span class="dv">1</span>], t[<span class="dv">2</span>]),
    <span class="kw">coef</span>(modconst)
  )
                     
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># gather data</span>
d &lt;-<span class="st"> </span><span class="kw">cbind</span>(
  <span class="st">&quot;Excess Returns&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">window</span>(StockReturns[,<span class="dv">1</span>], <span class="kw">c</span>(<span class="dv">1993</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))),
  <span class="st">&quot;Model (3)&quot;</span> =<span class="st"> </span>forecasts[<span class="dv">1</span>,], 
  <span class="st">&quot;Intercept Only&quot;</span> =<span class="st"> </span>forecasts[<span class="dv">2</span>,], 
  <span class="st">&quot;Always Zero&quot;</span> =<span class="st">  </span><span class="dv">0</span>)

<span class="co"># Compute RMSFEs</span>
<span class="kw">c</span>(
  <span class="st">&quot;ADL model (3)&quot;</span> =<span class="st"> </span><span class="kw">sd</span>(d[, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>d[, <span class="dv">2</span>]),
  <span class="st">&quot;Intercept-only model&quot;</span> =<span class="st"> </span><span class="kw">sd</span>(d[, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>d[, <span class="dv">3</span>]),
  <span class="st">&quot;Always zero&quot;</span> =<span class="st"> </span><span class="kw">sd</span>(d[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>d[, <span class="dv">4</span>])
)</code></pre></div>
<pre><code>##        ADL model (3) Intercept-only model          Always zero 
##             4.043757             4.000221             3.995428</code></pre>
<p>The comparison indicates that model (3) is not useful since it is outperformed in terms of sample RMSFE by the intercept-only model. A model forecasting excess returns always to be zero has an even lower sample RMSFE. This finding is consistent with the strong-form efficiency hypothesis which states that all publicly available information is accounted for in stock prices such that there is no way to predict future stock prices or excess returns using past observations, implying that the perceived significant relationship indicated by model (3) is wrong.</p>
<div id="summary" class="section level4 unnumbered">
<h4>Summary</h4>
<p>This chapter dealt with introductory topics in time series regression analysis, where variables are generally correlated from one observation to the next, a concept termed serial correlation. At the beginning, several ways of storing and plotting time series data using <tt>R</tt> have been presented and used for informal analysis of economic example data.</p>
<p>We have introduced AR and ADL models and applied them in the context of forecasting of macroeconomic and financial time series using <tt>R</tt>. The discussion also included the topic of lag length selection. It was shown how to set up a simple function that computes the BIC for a model object supplied.</p>
<p>We have also seen how to write simple <tt>R</tt> code for performing and evaluating forecasts and demonstrated some more sophisticated approaches to conduct pseudo-out-of-sample forecasts for assessment of a model’s predictive power for unobserved future outcomes of a series, to check model stability and to compare different models.</p>
<p>Furthermore, some more technical aspects like the concept of stationarity were addressed. This included applications to testing for an autoregressive unit root with the Dickey-Fuller test and the detection of a break in the population regression function using the <span class="math inline">\(QLR\)</span> statistic. For both methods, the distribution of the relevant test statistic is non-normal, even in large samples. Concerning the Dickey-Fuller test we have used <tt>R</tt>’s random number generation facilities to produce evidence for this by means of a Monte-Carlo simulation and motivated usage of the quantiles tabulated in the book.</p>
<p>Also, empirical studies regarding the validity of the weak and the strong form efficiency hypothesis which are presented in the applications <em>Can You Beat the Market? Part I &amp; II</em> in the book have been reproduced using <tt>R</tt>.</p>
<p>In all applications presented in this chapter, the focus was layed on forecasting future outcomes rather than estimation of causal relationships between time series variables. However, the framework of methods needed for the latter is very similar. Chapter <a href="#eodce"><strong>??</strong></a> is devoted to estimation of so called <em>dynamic causal effects</em>.</p>

<div id="refs" class="references">
<div>
<p>Allaire, J., Xie, Y., McPherson, J., Luraschi, J., Ushey, K., Atkins, A., … Chang, W. (2018). <em>Rmarkdown: Dynamic documents for r</em>. Retrieved from <a href="https://CRAN.R-project.org/package=rmarkdown" class="uri">https://CRAN.R-project.org/package=rmarkdown</a></p>
</div>
<div>
<p>Chow, G. C. (1960). Tests of equality between sets of coefficients in two linear regressions. <em>Econometrica</em>, <em>28</em>(3), 591–605.</p>
</div>
<div>
<p>Dickey, D. A., &amp; Fuller, W. A. (1979). Distribution of the estimators for autoregressive time series with a unit root. <em>Journal of the American Statistical Association</em>, <em>74</em>(366), pp. 427–431.</p>
</div>
<div>
<p>Granger, C. (1969). Investigating causal relations by econometric models and cross-spectral methods. <em>Econometrica</em>, <em>37</em>(3), 424–438.</p>
</div>
<div>
<p>Heiss, F. (2016). <em>Using R for Introductory Econometrics</em>. CreateSpace Independent Publishing Platform.</p>
</div>
<div>
<p>Hlavac, M. (2018). <em>Stargazer: Well-formatted regression and summary statistics tables</em>. Retrieved from <a href="https://CRAN.R-project.org/package=stargazer" class="uri">https://CRAN.R-project.org/package=stargazer</a></p>
</div>
<div>
<p>Hyndman, R., Athanasopoulos, G., Bergmeir, C., Caceres, G., Chhay, L., O’Hara-Wild, M., … Yasmeen, F. (2018). <em>Forecast: Forecasting functions for time series and linear models</em>. Retrieved from <a href="https://CRAN.R-project.org/package=forecast" class="uri">https://CRAN.R-project.org/package=forecast</a></p>
</div>
<div>
<p>Kleiber, C., &amp; Zeileis, A. (2008). <em>Applied econometrics with r</em>. Springer.</p>
</div>
<div>
<p>Kleiber, C., &amp; Zeileis, A. (2017). <em>AER: Applied econometrics with r</em>. Retrieved from <a href="https://CRAN.R-project.org/package=AER" class="uri">https://CRAN.R-project.org/package=AER</a></p>
</div>
<div>
<p>Quandt, R. E. (1960). Tests of the hypothesis that a linear regression system obeys two separate regimes. <em>Journal of the American Statistical Association</em>, <em>55</em>(290), 324–330. doi:<a href="https://doi.org/10.1080/01621459.1960.10482067">10.1080/01621459.1960.10482067</a></p>
</div>
<div>
<p>R Core Team. (2018). <em>R: A language and environment for statistical computing</em>. Vienna, Austria: R Foundation for Statistical Computing. Retrieved from <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a></p>
</div>
<div>
<p>Ryan, J. A., &amp; Ulrich, J. M. (2018). <em>Quantmod: Quantitative financial modelling framework</em>. Retrieved from <a href="https://CRAN.R-project.org/package=quantmod" class="uri">https://CRAN.R-project.org/package=quantmod</a></p>
</div>
<div>
<p>Stock, J., &amp; Watson, M. (2015). <em>Introduction to econometrics, third update, global edition</em>. Pearson Education Limited.</p>
</div>
<div>
<p>Wickham, H. (2017). <em>Scales: Scale functions for visualization</em>. Retrieved from <a href="https://CRAN.R-project.org/package=scales" class="uri">https://CRAN.R-project.org/package=scales</a></p>
</div>
<div>
<p>Wickham, H., &amp; Bryan, J. (2018). <em>Readxl: Read excel files</em>. Retrieved from <a href="https://CRAN.R-project.org/package=readxl" class="uri">https://CRAN.R-project.org/package=readxl</a></p>
</div>
<div>
<p>Wooldridge, J. (2016). <em>Introductory econometrics</em> (Sixth). Cengage Learning.</p>
</div>
<div>
<p>Xie, Y. (2018). <em>Knitr: A general-purpose package for dynamic report generation in r</em>. Retrieved from <a href="https://CRAN.R-project.org/package=knitr" class="uri">https://CRAN.R-project.org/package=knitr</a></p>
</div>
<div>
<p>Zeileis, A. (2016). <em>Dynlm: Dynamic linear regression</em>. Retrieved from <a href="https://CRAN.R-project.org/package=dynlm" class="uri">https://CRAN.R-project.org/package=dynlm</a></p>
</div>
</div>
</div>
</div>
<!-- </div> -->








            </section>

          </div>
        </div>
      </div>
<a href="niib.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 1
},
"edit": null,
"download": ["URFITE.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
