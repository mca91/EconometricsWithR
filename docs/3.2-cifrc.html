<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Confidence Intervals for Regression Coefficients | Introduction to Econometrics with R</title>
  <meta name="description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Confidence Intervals for Regression Coefficients | Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.econometrics-with-r.org//images/cover.png" />
  <meta property="og:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="github-repo" content="mca91/EconometricsWithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Confidence Intervals for Regression Coefficients | Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="twitter:image" content="https://www.econometrics-with-r.org//images/cover.png" />

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber, and Martin Schmelzer" />


<meta name="date" content="2023-07-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="3.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"/>
<link rel="next" href="3.3-rwxiabv.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- font families -->

<link href="https://fonts.googleapis.com/css?family=PT+Sans|Pacifico|Source+Sans+Pro" rel="stylesheet">

<script src="js/hideOutput.js"></script>

<!-- Mathjax -->
<script type="text/javascript" id="MathJax-script" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/mml-chtml.min.js"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script type="application/json" class="js-hypothesis-config">
{
"showHighlights": false
}
</script>
<script async defer src="https://hypothes.is/embed.js"></script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><center><img src="images/logo.png" alt="logo" width="50%" height="50%"style="margin: 15px 0 0 0"></center></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-colophon.html"><a href="1.1-colophon.html"><i class="fa fa-check"></i><b>1.1</b> Colophon</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-a-very-short-introduction-to-r-and-rstudio.html"><a href="1.2-a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.2</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-lrwor.html"><a href="2-lrwor.html"><i class="fa fa-check"></i><b>2</b> Linear Regression with One Regressor</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-simple-linear-regression.html"><a href="2.1-simple-linear-regression.html"><i class="fa fa-check"></i><b>2.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="2.2-estimating-the-coefficients-of-the-linear-regression-model.html"><i class="fa fa-check"></i><b>2.2</b> Estimating the Coefficients of the Linear Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="2.2-estimating-the-coefficients-of-the-linear-regression-model.html"><a href="2.2-estimating-the-coefficients-of-the-linear-regression-model.html#the-ordinary-least-squares-estimator"><i class="fa fa-check"></i>The Ordinary Least Squares Estimator</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2.3-measures-of-fit.html"><a href="2.3-measures-of-fit.html"><i class="fa fa-check"></i><b>2.3</b> Measures of Fit</a>
<ul>
<li class="chapter" data-level="" data-path="2.3-measures-of-fit.html"><a href="2.3-measures-of-fit.html#the-coefficient-of-determination"><i class="fa fa-check"></i>The Coefficient of Determination</a></li>
<li class="chapter" data-level="" data-path="2.3-measures-of-fit.html"><a href="2.3-measures-of-fit.html#the-standard-error-of-the-regression"><i class="fa fa-check"></i>The Standard Error of the Regression</a></li>
<li class="chapter" data-level="" data-path="2.3-measures-of-fit.html"><a href="2.3-measures-of-fit.html#application-to-the-test-score-data"><i class="fa fa-check"></i>Application to the Test Score Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-tlsa.html"><a href="2.4-tlsa.html"><i class="fa fa-check"></i><b>2.4</b> The Least Squares Assumptions</a>
<ul>
<li class="chapter" data-level="" data-path="2.4-tlsa.html"><a href="2.4-tlsa.html#assumption-1-the-error-term-has-conditional-mean-of-zero"><i class="fa fa-check"></i>Assumption 1: The Error Term has Conditional Mean of Zero</a></li>
<li class="chapter" data-level="" data-path="2.4-tlsa.html"><a href="2.4-tlsa.html#assumption-2-independently-and-identically-distributed-data"><i class="fa fa-check"></i>Assumption 2: Independently and Identically Distributed Data</a></li>
<li class="chapter" data-level="" data-path="2.4-tlsa.html"><a href="2.4-tlsa.html#assumption-3-large-outliers-are-unlikely"><i class="fa fa-check"></i>Assumption 3: Large Outliers are Unlikely</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2.5-tsdotoe.html"><a href="2.5-tsdotoe.html"><i class="fa fa-check"></i><b>2.5</b> The Sampling Distribution of the OLS Estimator</a>
<ul>
<li class="chapter" data-level="" data-path="2.5-tsdotoe.html"><a href="2.5-tsdotoe.html#simulation-study-1"><i class="fa fa-check"></i>Simulation Study 1</a></li>
<li class="chapter" data-level="" data-path="2.5-tsdotoe.html"><a href="2.5-tsdotoe.html#simulation-study-2"><i class="fa fa-check"></i>Simulation Study 2</a></li>
<li class="chapter" data-level="" data-path="2.5-tsdotoe.html"><a href="2.5-tsdotoe.html#simulation-study-3"><i class="fa fa-check"></i>Simulation Study 3</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2.6-exercises-4.html"><a href="2.6-exercises-4.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-htaciitslrm.html"><a href="3-htaciitslrm.html"><i class="fa fa-check"></i><b>3</b> Hypothesis Tests and Confidence Intervals in the Simple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><a href="3.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html"><i class="fa fa-check"></i><b>3.1</b> Testing Two-Sided Hypotheses Concerning the Slope Coefficient</a></li>
<li class="chapter" data-level="3.2" data-path="3.2-cifrc.html"><a href="3.2-cifrc.html"><i class="fa fa-check"></i><b>3.2</b> Confidence Intervals for Regression Coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="3.2-cifrc.html"><a href="3.2-cifrc.html#simulation-study-confidence-intervals"><i class="fa fa-check"></i>Simulation Study: Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-rwxiabv.html"><a href="3.3-rwxiabv.html"><i class="fa fa-check"></i><b>3.3</b> Regression when X is a Binary Variable</a></li>
<li class="chapter" data-level="3.4" data-path="3.4-hah.html"><a href="3.4-hah.html"><i class="fa fa-check"></i><b>3.4</b> Heteroskedasticity and Homoskedasticity</a>
<ul>
<li class="chapter" data-level="" data-path="3.4-hah.html"><a href="3.4-hah.html#a-real-world-example-for-heteroskedasticity"><i class="fa fa-check"></i>A Real-World Example for Heteroskedasticity</a></li>
<li class="chapter" data-level="" data-path="3.4-hah.html"><a href="3.4-hah.html#should-we-care-about-heteroskedasticity"><i class="fa fa-check"></i>Should We Care About Heteroskedasticity?</a></li>
<li class="chapter" data-level="" data-path="3.4-hah.html"><a href="3.4-hah.html#computation-of-heteroskedasticity-robust-standard-errors"><i class="fa fa-check"></i>Computation of Heteroskedasticity-Robust Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3.5-the-gauss-markov-theorem.html"><a href="3.5-the-gauss-markov-theorem.html"><i class="fa fa-check"></i><b>3.5</b> The Gauss-Markov Theorem</a>
<ul>
<li class="chapter" data-level="" data-path="3.5-the-gauss-markov-theorem.html"><a href="3.5-the-gauss-markov-theorem.html#simulation-study-blue-estimator"><i class="fa fa-check"></i>Simulation Study: BLUE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><a href="3.6-using-the-t-statistic-in-regression-when-the-sample-size-is-small.html"><i class="fa fa-check"></i><b>3.6</b> Using the t-Statistic in Regression When the Sample Size Is Small</a></li>
<li class="chapter" data-level="3.7" data-path="3.7-exercises-5.html"><a href="3.7-exercises-5.html"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click "Annotate" in the pop-up menu. You can also see the annotations of others: click the arrow in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="cifrc" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Confidence Intervals for Regression Coefficients<a href="3.2-cifrc.html#cifrc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we already know, estimates of the regression coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are subject to sampling uncertainty, see Chapter <a href="2-lrwor.html#lrwor">2</a>. Therefore, we will <em>never</em> exactly estimate the true value of these parameters from sample data in an empirical application. However, we may construct confidence intervals for the intercept and the slope parameter.</p>
<p>A <span class="math inline">\(95\%\)</span> confidence interval for <span class="math inline">\(\beta_i\)</span> has two equivalent definitions:</p>
<ul>
<li>The interval is the set of values for which a hypothesis test to the level of <span class="math inline">\(5\%\)</span> cannot be rejected.</li>
<li>The interval has a probability of <span class="math inline">\(95\%\)</span> to contain the true value of <span class="math inline">\(\beta_i\)</span>. So in <span class="math inline">\(95\%\)</span> of all samples that could be drawn, the confidence interval will cover the true value of <span class="math inline">\(\beta_i\)</span>.</li>
</ul>
<p>We also say that the interval has a confidence level of <span class="math inline">\(95\%\)</span>. The idea of the confidence interval is summarized in Key Concept 5.3.</p>
<div id="KC5.3" class="keyconcept">
<h3 class="right">
Key Concept 5.3
</h3>
<h3 class="left">
A Confidence Interval for <span class="math inline">\(\beta_i\)</span>
</h3>
<p>Imagine you could draw all possible random samples of given size. The interval that contains the true value <span class="math inline">\(\beta_i\)</span> in <span class="math inline">\(95\%\)</span> of all samples is given by the expression</p>
<p><span class="math display">\[ \text{CI}_{0.95}^{\beta_i} = \left[ \hat{\beta}_i - 1.96 \times SE(\hat{\beta}_i) \, , \, \hat{\beta}_i + 1.96 \times SE(\hat{\beta}_i) \right]. \]</span></p>
<p>Equivalently, this interval can be seen as the set of null hypotheses for which a <span class="math inline">\(5\%\)</span> two-sided hypothesis test does not reject.</p>
</div>
<div id="simulation-study-confidence-intervals" class="section level3 unnumbered hasAnchor">
<h3>Simulation Study: Confidence Intervals<a href="3.2-cifrc.html#simulation-study-confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To get a better understanding of confidence intervals we conduct another simulation study. For now, assume that we have the following sample of <span class="math inline">\(n=100\)</span> observations on a single variable <span class="math inline">\(Y\)</span> where</p>
<p><span class="math display">\[ Y_i \overset{i.i.d}{\sim} \mathcal{N}(5,25), \ i = 1, \dots, 100.\]</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="3.2-cifrc.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for reproducibility</span></span>
<span id="cb40-2"><a href="3.2-cifrc.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb40-3"><a href="3.2-cifrc.html#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="3.2-cifrc.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># generate and plot the sample data</span></span>
<span id="cb40-5"><a href="3.2-cifrc.html#cb40-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, </span>
<span id="cb40-6"><a href="3.2-cifrc.html#cb40-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">mean =</span> <span class="dv">5</span>, </span>
<span id="cb40-7"><a href="3.2-cifrc.html#cb40-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb40-8"><a href="3.2-cifrc.html#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="3.2-cifrc.html#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Y, </span>
<span id="cb40-10"><a href="3.2-cifrc.html#cb40-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, </span>
<span id="cb40-11"><a href="3.2-cifrc.html#cb40-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-76-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>We assume that the data is generated by the model</p>
<p><span class="math display">\[ Y_i = \mu + \epsilon_i \]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is an unknown constant and we know that <span class="math inline">\(\epsilon_i \overset{i.i.d.}{\sim} \mathcal{N}(0,25)\)</span>. In this model, the OLS estimator for <span class="math inline">\(\mu\)</span> is given by <span class="math display">\[ \hat\mu = \overline{Y} = \frac{1}{n} \sum_{i=1}^n Y_i, \]</span> i.e., the sample average of the <span class="math inline">\(Y_i\)</span>. It further holds that</p>
<p><span class="math display">\[ SE(\hat\mu) = \frac{\sigma_{\epsilon}}{\sqrt{n}} = \frac{5}{\sqrt{100}} \]</span></p>
<p>(see Chapter <a href="#SVSSDASE">2</a>) A large-sample <span class="math inline">\(95\%\)</span> confidence interval for <span class="math inline">\(\mu\)</span> is then given by</p>
<p><span class="math display" id="eq:KI">\[\begin{equation}
CI^{\mu}_{0.95} = \left[\hat\mu - 1.96 \times \frac{5}{\sqrt{100}} \ , \ \hat\mu + 1.96 \times \frac{5}{\sqrt{100}}  \right]. \tag{3.1}
\end{equation}\]</span></p>
<p>It is fairly easy to compute this interval in <tt>R</tt> by hand. The following code chunk generates a named vector containing the interval bounds:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="3.2-cifrc.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="at">CIlower =</span> <span class="fu">mean</span>(Y) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">10</span>, <span class="at">CIupper =</span> <span class="fu">mean</span>(Y) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">10</span>)</span>
<span id="cb41-2"><a href="3.2-cifrc.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       CIlower  CIupper</span></span>
<span id="cb41-3"><a href="3.2-cifrc.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 4.502625 6.462625</span></span></code></pre></div>
<p>Knowing that <span class="math inline">\(\mu = 5\)</span> we see that, for our example data, the confidence interval covers the true value.</p>
<p>As opposed to real world examples, we can use <tt>R</tt> to get a better understanding of confidence intervals by repeatedly sampling data, estimating <span class="math inline">\(\mu\)</span> and computing the confidence interval for <span class="math inline">\(\mu\)</span> as in <a href="3.2-cifrc.html#eq:KI">(3.1)</a>.</p>
<p>The procedure is as follows:</p>
<ul>
<li>We initialize the vectors <tt>lower</tt> and <tt>upper</tt> in which the simulated interval limits are to be saved. We want to simulate <span class="math inline">\(10000\)</span> intervals so both vectors are set to have this length.</li>
<li>We use a <tt>for()</tt> loop to sample <span class="math inline">\(100\)</span> observations from the <span class="math inline">\(\mathcal{N}(5,25)\)</span> distribution and compute <span class="math inline">\(\hat\mu\)</span> as well as the boundaries of the confidence interval in every iteration of the loop.</li>
<li>At last we join <tt>lower</tt> and <tt>upper</tt> in a matrix.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="3.2-cifrc.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb42-2"><a href="3.2-cifrc.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb42-3"><a href="3.2-cifrc.html#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="3.2-cifrc.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize vectors of lower and upper interval boundaries</span></span>
<span id="cb42-5"><a href="3.2-cifrc.html#cb42-5" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb42-6"><a href="3.2-cifrc.html#cb42-6" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10000</span>)</span>
<span id="cb42-7"><a href="3.2-cifrc.html#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="3.2-cifrc.html#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># loop sampling / estimation / CI</span></span>
<span id="cb42-9"><a href="3.2-cifrc.html#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb42-10"><a href="3.2-cifrc.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-11"><a href="3.2-cifrc.html#cb42-11" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb42-12"><a href="3.2-cifrc.html#cb42-12" aria-hidden="true" tabindex="-1"></a>  lower[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb42-13"><a href="3.2-cifrc.html#cb42-13" aria-hidden="true" tabindex="-1"></a>  upper[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="dv">5</span> <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb42-14"><a href="3.2-cifrc.html#cb42-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-15"><a href="3.2-cifrc.html#cb42-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-16"><a href="3.2-cifrc.html#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="3.2-cifrc.html#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># join vectors of interval bounds in a matrix</span></span>
<span id="cb42-18"><a href="3.2-cifrc.html#cb42-18" aria-hidden="true" tabindex="-1"></a>CIs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lower, upper)</span></code></pre></div>
<p>According to Key Concept 5.3 we expect that the fraction of the <span class="math inline">\(10000\)</span> simulated intervals saved in the matrix <tt>CIs</tt> that contain the true value <span class="math inline">\(\mu=5\)</span> should be roughly <span class="math inline">\(95\%\)</span>. We can easily check this using logical operators.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="3.2-cifrc.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(CIs[, <span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> <span class="dv">5</span> <span class="sc">&lt;=</span> CIs[, <span class="dv">2</span>])</span>
<span id="cb43-2"><a href="3.2-cifrc.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9487</span></span></code></pre></div>
<p>The simulation shows that the fraction of intervals covering <span class="math inline">\(\mu=5\)</span>, i.e., those intervals for which <span class="math inline">\(H_0: \mu = 5\)</span> cannot be rejected is close to the theoretical value of <span class="math inline">\(95\%\)</span>.</p>
<p>Let us draw a plot of the first <span class="math inline">\(100\)</span> simulated confidence intervals and indicate those which <em>do not</em> cover the true value of <span class="math inline">\(\mu\)</span>. We do this via horizontal lines representing the confidence intervals on top of each other.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="3.2-cifrc.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identify intervals not covering mu</span></span>
<span id="cb44-2"><a href="3.2-cifrc.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (4 intervals out of 100)</span></span>
<span id="cb44-3"><a href="3.2-cifrc.html#cb44-3" aria-hidden="true" tabindex="-1"></a>ID <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span>(CIs[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">1</span>] <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> <span class="dv">5</span> <span class="sc">&lt;=</span> CIs[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">2</span>]))</span>
<span id="cb44-4"><a href="3.2-cifrc.html#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="3.2-cifrc.html#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize the plot</span></span>
<span id="cb44-6"><a href="3.2-cifrc.html#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span>, </span>
<span id="cb44-7"><a href="3.2-cifrc.html#cb44-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>), </span>
<span id="cb44-8"><a href="3.2-cifrc.html#cb44-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>), </span>
<span id="cb44-9"><a href="3.2-cifrc.html#cb44-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Sample&quot;</span>, </span>
<span id="cb44-10"><a href="3.2-cifrc.html#cb44-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(mu), </span>
<span id="cb44-11"><a href="3.2-cifrc.html#cb44-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Confidence Intervals&quot;</span>)</span>
<span id="cb44-12"><a href="3.2-cifrc.html#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="3.2-cifrc.html#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co"># set up color vector</span></span>
<span id="cb44-14"><a href="3.2-cifrc.html#cb44-14" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">gray</span>(<span class="fl">0.6</span>), <span class="dv">100</span>)</span>
<span id="cb44-15"><a href="3.2-cifrc.html#cb44-15" aria-hidden="true" tabindex="-1"></a>colors[ID] <span class="ot">&lt;-</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb44-16"><a href="3.2-cifrc.html#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="3.2-cifrc.html#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># draw reference line at mu=5</span></span>
<span id="cb44-18"><a href="3.2-cifrc.html#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb44-19"><a href="3.2-cifrc.html#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="3.2-cifrc.html#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add horizontal bars representing the CIs</span></span>
<span id="cb44-21"><a href="3.2-cifrc.html#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb44-22"><a href="3.2-cifrc.html#cb44-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-23"><a href="3.2-cifrc.html#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">c</span>(CIs[j, <span class="dv">1</span>], CIs[j, <span class="dv">2</span>]), </span>
<span id="cb44-24"><a href="3.2-cifrc.html#cb44-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(j, j), </span>
<span id="cb44-25"><a href="3.2-cifrc.html#cb44-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> colors[j], </span>
<span id="cb44-26"><a href="3.2-cifrc.html#cb44-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-27"><a href="3.2-cifrc.html#cb44-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-28"><a href="3.2-cifrc.html#cb44-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-80-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p>For the first <span class="math inline">\(100\)</span> samples, the true null hypothesis is rejected in four cases so these intervals do not cover <span class="math inline">\(\mu=5\)</span>. We have indicated the intervals which lead to a rejection of the null red.</p>
<p>Let us now come back to the example of test scores and class sizes. The regression model from Chapter <a href="2-lrwor.html#lrwor">2</a> is stored in <tt>linear_model</tt>. An easy way to get <span class="math inline">\(95\%\)</span> confidence intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, the coefficients on <tt>(intercept)</tt> and <tt>STR</tt>, is to use the function <tt>confint()</tt>. We only have to provide a fitted model object as an input to this function. The confidence level is set to <span class="math inline">\(95\%\)</span> by default but can be modified by setting the argument <tt>level</tt>, see <tt>?confint</tt>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="3.2-cifrc.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute 95% confidence interval for coefficients in &#39;linear_model&#39;</span></span>
<span id="cb45-2"><a href="3.2-cifrc.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(linear_model)</span>
<span id="cb45-3"><a href="3.2-cifrc.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 2.5 %     97.5 %</span></span>
<span id="cb45-4"><a href="3.2-cifrc.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) 680.32312 717.542775</span></span>
<span id="cb45-5"><a href="3.2-cifrc.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; STR          -3.22298  -1.336636</span></span></code></pre></div>
<p>Let us check if the calculation is done as we expect it to be for <span class="math inline">\(\beta_1\)</span>, the coefficient on <tt>STR</tt>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="3.2-cifrc.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute 95% confidence interval for coefficients in &#39;linear_model&#39; by hand</span></span>
<span id="cb46-2"><a href="3.2-cifrc.html#cb46-2" aria-hidden="true" tabindex="-1"></a>lm_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(linear_model)</span>
<span id="cb46-3"><a href="3.2-cifrc.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="3.2-cifrc.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;lower&quot;</span> <span class="ot">=</span> lm_sum<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> lm_sum<span class="sc">$</span>df[<span class="dv">2</span>]) <span class="sc">*</span> lm_sum<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">2</span>],</span>
<span id="cb46-5"><a href="3.2-cifrc.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;upper&quot;</span> <span class="ot">=</span> lm_sum<span class="sc">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> lm_sum<span class="sc">$</span>df[<span class="dv">2</span>]) <span class="sc">*</span> lm_sum<span class="sc">$</span>coef[<span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb46-6"><a href="3.2-cifrc.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     lower     upper </span></span>
<span id="cb46-7"><a href="3.2-cifrc.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.222980 -1.336636</span></span></code></pre></div>
<p>The upper and the lower bounds coincide. We have used the <span class="math inline">\(0.975\)</span>-quantile of the <span class="math inline">\(t_{418}\)</span> distribution to get the exact result reported by <tt>confint</tt>. Obviously, this interval <em>does not</em> contain the value zero which, as we have already seen in the previous section, leads to the rejection of the null hypothesis <span class="math inline">\(\beta_{1,0} = 0\)</span>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3.1-testing-two-sided-hypotheses-concerning-the-slope-coefficient.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="3.3-rwxiabv.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/mca91/EconometricsWithR/edit/master/05-ch5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ITER.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
