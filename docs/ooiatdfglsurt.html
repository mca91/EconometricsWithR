<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Using R for Introduction to Econometrics</title>
  <meta name="description" content="Using <tt>R</tt> for Introduction to Econometrics">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Using R for Introduction to Econometrics" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="Emwikts1970/URFITE-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Using R for Introduction to Econometrics" />
  
  
  

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber and Martin Schmelzer">


<meta name="date" content="2018-08-02">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="vector-autoregressions.html">
<link rel="next" href="cointegration.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="js/hideOutput.js"></script>
<script type="text/javascript" src="MathJax-2.7.2/MathJax.js?config=default"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>

<!-- datacamp-light-latest -->

<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>


<!-- <script src="js/d3.v3.min.js"></script>
<script src="js/leastsquares.js"></script>
<script src="js/d3functions.js"></script>
<script src="d3.slider.js"></script>
<script src="slrm.js"></script> -->


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">URFITE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="a-very-short-introduction-to-r-and-rstudio.html"><a href="a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="atitsr.html"><a href="atitsr.html"><i class="fa fa-check"></i><b>2</b> Additional Topics in Time Series Regression</a><ul>
<li class="chapter" data-level="2.1" data-path="vector-autoregressions.html"><a href="vector-autoregressions.html"><i class="fa fa-check"></i><b>2.1</b> Vector Autoregressions</a></li>
<li class="chapter" data-level="2.2" data-path="ooiatdfglsurt.html"><a href="ooiatdfglsurt.html"><i class="fa fa-check"></i><b>2.2</b> Orders of Integration and the DF-GLS Unit Root Test</a></li>
<li class="chapter" data-level="2.3" data-path="cointegration.html"><a href="cointegration.html"><i class="fa fa-check"></i><b>2.3</b> Cointegration</a></li>
<li class="chapter" data-level="2.4" data-path="volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><i class="fa fa-check"></i><b>2.4</b> Volatility Clustering and Autoregressive Conditional Heteroskedasticity</a><ul>
<li class="chapter" data-level="" data-path="volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html#arch-and-garch-models"><i class="fa fa-check"></i>ARCH and GARCH Models</a></li>
<li class="chapter" data-level="" data-path="volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html"><a href="volatility-clustering-and-autoregressive-conditional-heteroskedasticity.html#application-to-stock-price-volatility"><i class="fa fa-check"></i>Application to Stock Price Volatility</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using <tt>R</tt> for Introduction to Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. You can also see the annotations of others: click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="ooiatdfglsurt" class="section level2">
<h2><span class="header-section-number">2.2</span> Orders of Integration and the DF-GLS Unit Root Test</h2>
<p>Some economic time series have smoother trends than variables that can be described by random walk models. A way to model these time series is <span class="math display">\[\Delta Y_t = \beta_0 + \Delta Y_{t-1} + u_t,\]</span> where <span class="math inline">\(u_t\)</span> is a serially uncorrelated error term. This model states that the first difference of a series is a random walk. Consequently, the series of second differences of <span class="math inline">\(Y_t\)</span> is stationary. Key Concept 16.4 summarizes the notation.</p>
<div class="keyconcept">
<h3 class="right">
Key Concept <br> 16.4
</h3>
<h3 class="left">
Orders of Integration, Differencing and Stationarity
</h3>
<p>
<ul>
<li><p>When a time series <span class="math inline">\(Y_t\)</span> has a unit autoregressive root, <span class="math inline">\(Y_t\)</span> is integrated of order one. This is often denoted by <span class="math inline">\(Y_t \sim I(1)\)</span>. We simply say that <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(1)\)</span>. If <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(1)\)</span>, its first difference <span class="math inline">\(\Delta Y_t\)</span> is stationary.</p></li>
<li><p><span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(2)\)</span> when <span class="math inline">\(Y_t\)</span> needs to be differenced twice in order to obtain a stationary series. Using the notation introduced here, if <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(2)\)</span>, its first difference <span class="math inline">\(\Delta Y_t\)</span> is <span class="math inline">\(I(1)\)</span> and its second difference <span class="math inline">\(\Delta^2 Y_t\)</span> is stationary. <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(d)\)</span> when <span class="math inline">\(Y_t\)</span> must be differenced <span class="math inline">\(d\)</span> times to obtain a stationary series.</p></li>
<li><p>When <span class="math inline">\(Y_t\)</span> is stationary, it is integrated of order <span class="math inline">\(0\)</span> so <span class="math inline">\(Y_t\)</span> is <span class="math inline">\(I(0)\)</span>.</p></li>
</ul>
<p>It is fairly easy to obtain differences of time series in <tt>R</tt>. For example, the function <tt>diff()</tt> returns suitably lagged and iterated differences of numeric vectors, matrices and time series objects of the class <tt>ts</tt>.</p>
</p>
</div>
<p>Following the book, we take the price level of the U.S. measured by the <em>Personal Consumption Expenditures Price Index</em> as an example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define ts object of the U.S. PCE Price Index</span>
PCECTPI &lt;-<span class="st"> </span><span class="kw">ts</span>(<span class="kw">log</span>(USMacroSWQ<span class="op">$</span>PCECTPI), 
              <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1957</span>, <span class="dv">1</span>), 
              <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>), 
              <span class="dt">freq =</span> <span class="dv">4</span>)

<span class="co"># plot logarithm of the PCE Price Index</span>
<span class="kw">plot</span>(<span class="kw">log</span>(PCECTPI),
     <span class="dt">main =</span> <span class="st">&quot;Log of United States PCE Price Index&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Logarithm&quot;</span>,
     <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>, 
     <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="URFITE_files/figure-html/unnamed-chunk-31-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The logarithm of the price level has a smoothly varying trend. This is typical for an <span class="math inline">\(I(2)\)</span> series. If the price level is indeed <span class="math inline">\(I(2)\)</span>, the first differences of this series should be <span class="math inline">\(I(1)\)</span>. Since we are considering the logarithm of the price level, we obtain growth rates by taking first differences. Therefore, the differenced price level series is the series of quarterly inflation rates. This is quickly done in <tt>R</tt> using the function <tt>Delt()</tt> from the package <tt>quantmod</tt>. As explained in Chapter <a href="#tsdasc"><strong>??</strong></a>, multiplying the quarterly inflation rates by <span class="math inline">\(400\)</span> yields the quarterly rate of inflation, measured in percentage points at an annual rate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot U.S. PCE price inflation</span>
<span class="kw">plot</span>(<span class="dv">400</span> <span class="op">*</span><span class="st"> </span><span class="kw">Delt</span>(PCECTPI),
     <span class="dt">main =</span> <span class="st">&quot;United States PCE Price Index&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Percent per annum&quot;</span>,
     <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>, 
     <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="co"># add a dashed line at y =  0 </span>
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="URFITE_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The inflation rate behaves much more erratically than the smooth graph of the logarithm of the PCE price index.</p>
<div id="the-df-gls-test-for-a-unit-root" class="section level4 unnumbered">
<h4>The DF-GLS Test for a Unit Root</h4>
<p>The DF-GLS test for a unit root has been developed by <span class="citation">Elliott, Rothenberg, &amp; Stock (<a href="#ref-elliott1996">1996</a>)</span> and has higher power than the ADF test when the autoregressive root is large but less than one. That is, the DF-GLS has a higher probability of rejecting the false null of a stochastic trend when the sample data stems from a time series that is close to being integrated.</p>
<p>The idea of the DF-GLS test is to test for an autoregressive unit root in the detrended series, whereby GLS estimates of the deterministic components are used to obtain the detrended version of the original series. See Chapter 16.3 of the book for a more detailed explanation of the approach.</p>
<p>A function that performs the DF-GLS test is implemented in the package <tt>urca</tt> (this package is a dependency of the package <tt>vars</tt> so it should be already loaded if <tt>vars</tt> is attached). The function that computes the test statistic is <tt>ur.ers</tt>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># DF-GLS test for unit root in GDP</span>
<span class="kw">summary</span>(<span class="kw">ur.ers</span>(<span class="kw">log</span>(<span class="kw">window</span>(GDP, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1962</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2012</span>, <span class="dv">4</span>))),
        <span class="dt">model =</span> <span class="st">&quot;trend&quot;</span>, 
        <span class="dt">lag.max =</span> <span class="dv">2</span>))</code></pre></div>
<pre><code>## 
## ############################################### 
## # Elliot, Rothenberg and Stock Unit Root Test # 
## ############################################### 
## 
## Test of type DF-GLS 
## detrending of series with intercept and trend 
## 
## 
## Call:
## lm(formula = dfgls.form, data = data.dfgls)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.025739 -0.004054  0.000017  0.004619  0.033620 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## yd.lag       -0.01213    0.01012  -1.199  0.23207    
## yd.diff.lag1  0.28583    0.07002   4.082 6.47e-05 ***
## yd.diff.lag2  0.19320    0.07058   2.737  0.00676 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.007807 on 198 degrees of freedom
## Multiple R-squared:  0.1504, Adjusted R-squared:  0.1376 
## F-statistic: 11.69 on 3 and 198 DF,  p-value: 4.392e-07
## 
## 
## Value of test-statistic is: -1.1987 
## 
## Critical values of DF-GLS are:
##                  1pct  5pct 10pct
## critical values -3.48 -2.89 -2.57</code></pre>
<p>The summary of the test shows that the test statistic is about <span class="math inline">\(-1.2\)</span>. The the <span class="math inline">\(10\%\)</span> critical value for the DF-GLS test is <span class="math inline">\(-2.57\)</span>. This is, however, <strong>not</strong> the appropriate critical value for the ADF test when an intercept and a time trend are included in the Dickey-Fuller regression: the asymptotic distributions of both test statistics differ and so do their critical values!</p>
<p>The test is left-sided so we cannot reject the null hypothesis that U.S. inflation is nonstationary, using the DF-GLS test.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-elliott1996">
<p>Elliott, G., Rothenberg, T. J., &amp; Stock, J. H. (1996). Efficient Tests for an Autoregressive Unit Root. <em>Econometrica</em>, <em>64</em>(4), 813â€“836.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vector-autoregressions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cointegration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 1
},
"edit": null,
"download": ["URFITE.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
